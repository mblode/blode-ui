{
  "$schema": "https://ui.blode.co/schema/registry-item.json",
  "name": "accordion",
  "title": "Accordion",
  "author": "Matthew Blode",
  "description": "A vertically stacked set of interactive headings that reveal or hide associated content.",
  "dependencies": [
    "@base-ui/react"
  ],
  "files": [
    {
      "path": "ui/accordion.tsx",
      "content": "\"use client\";\n\nimport { Accordion as AccordionPrimitive } from \"@base-ui/react/accordion\";\nimport {\n  AnimatePresence,\n  type HTMLMotionProps,\n  motion,\n  type Transition,\n} from \"motion/react\";\nimport {\n  type ComponentProps,\n  createContext,\n  useCallback,\n  useContext,\n  useEffect,\n  useImperativeHandle,\n  useRef,\n  useState,\n} from \"react\";\n\nimport { cn } from \"@/lib/utils\";\n\ninterface AccordionItemContextType {\n  isOpen: boolean;\n  setIsOpen: (open: boolean) => void;\n}\n\nconst AccordionItemContext = createContext<\n  AccordionItemContextType | undefined\n>(undefined);\n\nconst useAccordionItem = (): AccordionItemContextType => {\n  const context = useContext(AccordionItemContext);\n  if (!context) {\n    throw new Error(\"useAccordionItem must be used within an AccordionItem\");\n  }\n  return context;\n};\n\ntype AccordionValue = string | string[];\n\ntype AccordionProps = Omit<\n  ComponentProps<typeof AccordionPrimitive.Root>,\n  \"defaultValue\" | \"multiple\" | \"onValueChange\" | \"value\"\n> & {\n  type?: \"single\" | \"multiple\";\n  collapsible?: boolean;\n  value?: AccordionValue;\n  defaultValue?: AccordionValue;\n  onValueChange?: (value: AccordionValue) => void;\n};\n\nconst normalizeAccordionValue = (\n  value: AccordionValue | undefined\n): string[] | undefined => {\n  if (value === undefined) {\n    return undefined;\n  }\n\n  if (Array.isArray(value)) {\n    return value;\n  }\n\n  return value === \"\" ? [] : [value];\n};\n\nfunction Accordion({\n  type = \"single\",\n  collapsible = false,\n  value,\n  defaultValue,\n  onValueChange,\n  ...props\n}: AccordionProps) {\n  const multiple = type === \"multiple\";\n\n  const handleValueChange = useCallback(\n    (nextValue: (unknown | null)[]) => {\n      if (!onValueChange) {\n        return;\n      }\n\n      const nextStringValues = nextValue.filter(\n        (item): item is string => typeof item === \"string\"\n      );\n\n      if (multiple) {\n        onValueChange(nextStringValues);\n        return;\n      }\n\n      const firstValue = nextStringValues[0];\n      if (firstValue !== undefined) {\n        onValueChange(firstValue);\n        return;\n      }\n\n      if (collapsible) {\n        onValueChange(\"\");\n      }\n    },\n    [collapsible, multiple, onValueChange]\n  );\n\n  return (\n    <AccordionPrimitive.Root\n      data-slot=\"accordion\"\n      defaultValue={normalizeAccordionValue(defaultValue)}\n      multiple={multiple}\n      onValueChange={onValueChange ? handleValueChange : undefined}\n      value={normalizeAccordionValue(value)}\n      {...props}\n    />\n  );\n}\n\nfunction AccordionItem({\n  className,\n  children,\n  ...props\n}: ComponentProps<typeof AccordionPrimitive.Item>) {\n  const [isOpen, setIsOpen] = useState(false);\n\n  return (\n    <AccordionItemContext.Provider value={{ isOpen, setIsOpen }}>\n      <AccordionPrimitive.Item\n        className={cn(\"border-b last:border-b-0\", className)}\n        data-slot=\"accordion-item\"\n        {...props}\n      >\n        {children}\n      </AccordionPrimitive.Item>\n    </AccordionItemContext.Provider>\n  );\n}\n\ntype AccordionTriggerProps = ComponentProps<\n  typeof AccordionPrimitive.Trigger\n> & {\n  chevron?: boolean;\n  transition?: Transition;\n};\n\nfunction AccordionTrigger({\n  ref,\n  className,\n  children,\n  chevron = true,\n  transition = { type: \"spring\", stiffness: 150, damping: 22 },\n  ...props\n}: AccordionTriggerProps) {\n  const triggerRef = useRef<HTMLButtonElement | null>(null);\n  useImperativeHandle(ref, () => triggerRef.current as HTMLButtonElement);\n  const { isOpen, setIsOpen } = useAccordionItem();\n\n  useEffect(() => {\n    const node = triggerRef.current;\n    if (!node) {\n      return;\n    }\n\n    const updateState = () => {\n      const isExpanded =\n        node.hasAttribute(\"data-panel-open\") ||\n        node.getAttribute(\"aria-expanded\") === \"true\";\n      setIsOpen(isExpanded);\n    };\n\n    const observer = new MutationObserver((mutationsList) => {\n      for (const mutation of mutationsList) {\n        if (\n          mutation.attributeName === \"data-panel-open\" ||\n          mutation.attributeName === \"aria-expanded\"\n        ) {\n          updateState();\n        }\n      }\n    });\n\n    observer.observe(node, {\n      attributes: true,\n      attributeFilter: [\"data-panel-open\", \"aria-expanded\"],\n    });\n\n    updateState();\n\n    return () => {\n      observer.disconnect();\n    };\n  }, [setIsOpen]);\n\n  return (\n    <AccordionPrimitive.Header className=\"flex\">\n      <AccordionPrimitive.Trigger\n        className={cn(\n          \"flex flex-1 cursor-pointer items-start justify-between gap-4 rounded-md py-4 text-left font-medium text-sm outline-none transition-all focus-visible:border-ring focus-visible:ring-[3px] focus-visible:ring-ring/50 disabled:pointer-events-none disabled:opacity-50\",\n          className\n        )}\n        data-slot=\"accordion-trigger\"\n        ref={triggerRef}\n        {...props}\n      >\n        {children}\n        {chevron ? (\n          <div className=\"relative flex h-4 w-4 shrink-0 items-center justify-center\">\n            <motion.div\n              animate={{ rotate: isOpen ? 180 : 0 }}\n              className=\"pointer-events-none absolute h-0.5 w-4 rounded-full bg-foreground\"\n              transition={transition}\n            />\n            <motion.div\n              animate={{ rotateZ: isOpen ? 80 : 0, scale: isOpen ? 0 : 1 }}\n              className=\"pointer-events-none absolute h-4 w-0.5 rounded-full bg-foreground\"\n              style={{ transformOrigin: \"center\" }}\n              transition={transition}\n            />\n          </div>\n        ) : null}\n      </AccordionPrimitive.Trigger>\n    </AccordionPrimitive.Header>\n  );\n}\n\ntype AccordionContentProps = ComponentProps<typeof AccordionPrimitive.Panel> &\n  HTMLMotionProps<\"div\"> & {\n    transition?: Transition;\n  };\n\nfunction AccordionContent({\n  className,\n  children,\n  transition = { type: \"spring\", stiffness: 150, damping: 22 },\n  ...props\n}: AccordionContentProps) {\n  const { isOpen } = useAccordionItem();\n\n  return (\n    <AccordionPrimitive.Panel keepMounted {...props}>\n      <AnimatePresence initial={false}>\n        {isOpen ? (\n          <motion.div\n            animate={{ \"--mask-stop\": \"100%\", height: \"auto\", opacity: 1 }}\n            className=\"overflow-hidden\"\n            data-slot=\"accordion-content\"\n            exit={{ \"--mask-stop\": \"0%\", height: 0, opacity: 0 }}\n            initial={{ \"--mask-stop\": \"0%\", height: 0, opacity: 0 }}\n            key=\"accordion-content\"\n            style={{\n              WebkitMaskImage:\n                \"linear-gradient(black var(--mask-stop), transparent var(--mask-stop))\",\n              maskImage:\n                \"linear-gradient(black var(--mask-stop), transparent var(--mask-stop))\",\n            }}\n            transition={transition}\n          >\n            <div className={cn(\"pt-0 pb-4 text-sm leading-[1.5]\", className)}>\n              {children}\n            </div>\n          </motion.div>\n        ) : null}\n      </AnimatePresence>\n    </AccordionPrimitive.Panel>\n  );\n}\n\nexport { Accordion, AccordionItem, AccordionTrigger, AccordionContent };\n",
      "type": "registry:ui",
      "target": ""
    }
  ],
  "type": "registry:ui"
}
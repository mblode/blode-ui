{
  "$schema": "https://ui.blode.co/schema/registry-item.json",
  "name": "data-table",
  "author": "fingertip (https://ui.blode.co)",
  "dependencies": ["@tanstack/react-table"],
  "files": [
    {
      "path": "ui/data-table.tsx",
      "content": "\"use client\";\n\nimport {\n  ArrowDownIcon,\n  ArrowUpIcon,\n  ChevronLeftIcon,\n  ChevronRightIcon,\n} from \"blode-icons-react\";\nimport {\n  ColumnDef,\n  ColumnFiltersState,\n  flexRender,\n  getCoreRowModel,\n  getFilteredRowModel,\n  getPaginationRowModel,\n  getSortedRowModel,\n  OnChangeFn,\n  RowSelectionState,\n  SortingState,\n  useReactTable,\n  VisibilityState,\n} from \"@tanstack/react-table\";\nimport { useRouter } from \"next/navigation\";\nimport { ReactNode, useMemo, useState } from \"react\";\n\nimport { Button } from \"./button\";\nimport { Checkbox } from \"./checkbox\";\nimport {\n  Table,\n  TableBody,\n  TableCell,\n  TableHead,\n  TableHeader,\n  TableRow,\n} from \"./table\";\nimport { cn } from \"@/lib/utils\";\nimport { pluralize } from \"@/lib/utils\";\n\ninterface DataTableProps<TData, TValue> {\n  columns: ColumnDef<TData, TValue>[];\n  data: TData[];\n  defaultColumnVisibility?: VisibilityState;\n  children?: ReactNode;\n  baseUrl?: string;\n  hideFooter?: boolean;\n  onClick?: (item: any) => void;\n  enableRowSelection?: boolean;\n  selectedRows?: RowSelectionState;\n  setSelectedRows?: OnChangeFn<RowSelectionState>;\n}\n\nexport function DataTable<TData, TValue>({\n  columns,\n  data,\n  children,\n  baseUrl,\n  hideFooter,\n  defaultColumnVisibility,\n  onClick,\n  enableRowSelection = false,\n  selectedRows,\n  setSelectedRows,\n}: DataTableProps<TData, TValue>) {\n  const router = useRouter();\n  const [sorting, setSorting] = useState<SortingState>([]);\n  const [columnFilters, setColumnFilters] = useState<ColumnFiltersState>([]);\n  const [columnVisibility, setColumnVisibility] = useState<VisibilityState>(\n    defaultColumnVisibility || {},\n  );\n\n  // Create selection column when enableRowSelection is true\n  const selectionColumn: ColumnDef<TData, any> = {\n    id: \"select\",\n    header: ({ table }) => (\n      <Checkbox\n        checked={\n          table.getIsAllPageRowsSelected() ||\n          (table.getIsSomePageRowsSelected() && \"indeterminate\")\n        }\n        onCheckedChange={(value) => table.toggleAllPageRowsSelected(!!value)}\n        aria-label=\"Select all\"\n      />\n    ),\n    cell: ({ row }) => {\n      return (\n        <Checkbox\n          checked={selectedRows?.[row.id]}\n          onCheckedChange={(value) => row.toggleSelected(!!value)}\n          onClick={(e) => e.stopPropagation()}\n          aria-label=\"Select row\"\n        />\n      );\n    },\n    enableSorting: false,\n    enableHiding: false,\n  };\n\n  // Add selection column to columns when enableRowSelection is true\n  const allColumns = useMemo(\n    () => (enableRowSelection ? [selectionColumn, ...columns] : columns),\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    [enableRowSelection, columns, selectedRows],\n  );\n\n  const table = useReactTable({\n    data,\n    columns: allColumns,\n    onSortingChange: setSorting,\n    onColumnFiltersChange: setColumnFilters,\n    getCoreRowModel: getCoreRowModel(),\n    getPaginationRowModel: getPaginationRowModel(),\n    getSortedRowModel: getSortedRowModel(),\n    getFilteredRowModel: getFilteredRowModel(),\n    onColumnVisibilityChange: setColumnVisibility,\n    onRowSelectionChange: setSelectedRows,\n    state: {\n      sorting,\n      columnFilters,\n      columnVisibility,\n      rowSelection: selectedRows,\n    },\n    manualPagination: hideFooter,\n    enableRowSelection,\n  });\n\n  return (\n    <div>\n      <div>{children}</div>\n\n      <div className=\"rounded-md border border-border bg-card\">\n        <div>\n          <Table>\n            <TableHeader>\n              {table.getHeaderGroups().map((headerGroup) => (\n                <TableRow key={headerGroup.id}>\n                  {headerGroup.headers.map((header) => {\n                    return (\n                      <TableHead key={header.id}>\n                        {header.isPlaceholder ? null : (\n                          <div\n                            className={cn(\n                              \"flex items-center space-x-2\",\n                              header.column.getCanSort()\n                                ? \"cursor-pointer select-none\"\n                                : \"\",\n                            )}\n                            onClick={header.column.getToggleSortingHandler()}\n                          >\n                            {flexRender(\n                              header.column.columnDef.header,\n                              header.getContext(),\n                            )}\n                            {{\n                              asc: <ArrowUpIcon className=\"size-4\" />,\n                              desc: <ArrowDownIcon className=\"size-4\" />,\n                            }[header.column.getIsSorted() as string] ?? null}\n                          </div>\n                        )}\n                      </TableHead>\n                    );\n                  })}\n                </TableRow>\n              ))}\n            </TableHeader>\n\n            <TableBody>\n              {table.getRowModel().rows?.length ? (\n                table.getRowModel().rows.map((row) => (\n                  <TableRow\n                    data-state={selectedRows?.[row.id] ? \"selected\" : undefined}\n                    onClick={() => {\n                      if (onClick) {\n                        onClick?.(row.original as any);\n                      } else if (baseUrl) {\n                        router.push(`${baseUrl}/${(row.original as any).id}`);\n                      }\n                    }}\n                    key={row.id}\n                    className={cn({\n                      \"cursor-pointer\":\n                        !!baseUrl || !!onClick || enableRowSelection,\n                      \"bg-muted/50\": selectedRows?.[row.id],\n                    })}\n                  >\n                    {row.getVisibleCells().map((cell) => (\n                      <TableCell key={cell.id}>\n                        {flexRender(\n                          cell.column.columnDef.cell,\n                          cell.getContext(),\n                        )}\n                      </TableCell>\n                    ))}\n                  </TableRow>\n                ))\n              ) : (\n                <TableRow>\n                  <TableCell\n                    colSpan={allColumns.length}\n                    className=\"h-24 text-center\"\n                  >\n                    No results found\n                  </TableCell>\n                </TableRow>\n              )}\n            </TableBody>\n          </Table>\n        </div>\n      </div>\n\n      {!hideFooter && (\n        <div className=\"mt-4 flex flex-col-reverse gap-4 sm:flex-row sm:items-center sm:justify-between\">\n          <div className=\"text-center text-sm text-muted-foreground sm:text-left\">\n            <span className=\"font-semibold\">\n              {table.getFilteredRowModel().rows.length}\n            </span>{\" \"}\n            {pluralize(table.getFilteredRowModel().rows.length, \"result\")}\n          </div>\n\n          <div className=\"grid w-full grid-cols-2 gap-2 sm:flex sm:w-auto\">\n            <Button\n              variant=\"secondary\"\n              size=\"sm\"\n              onClick={() => table.previousPage()}\n              disabled={!table.getCanPreviousPage()}\n            >\n              <ChevronLeftIcon className=\"mr-1.5 shrink-0 size-4\" />\n              Previous\n            </Button>\n\n            <Button\n              variant=\"secondary\"\n              size=\"sm\"\n              onClick={() => table.nextPage()}\n              disabled={!table.getCanNextPage()}\n            >\n              Next\n              <ChevronRightIcon className=\"size-4 ml-1.5 shrink-0\" />\n            </Button>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n",
      "type": "registry:ui",
      "target": ""
    }
  ],
  "type": "registry:ui"
}
